(window.webpackJsonp=window.webpackJsonp||[]).push([[29],{177:function(t,s,e){"use strict";e.r(s);var n=e(0),a=Object(n.a)({},function(){var t=this,s=t.$createElement,e=t._self._c||s;return e("div",{staticClass:"content"},[t._m(0),t._v(" "),t._m(1),t._v(" "),e("p",[t._v("跟着 "),e("a",{attrs:{href:"https://promisesaplus.com/",target:"_blank",rel:"noopener noreferrer"}},[t._v("promiseA+规范"),e("OutboundLink")],1),t._v(" 一步步来，依次实现规范中的四个小节。")]),t._v(" "),t._m(2),t._v(" "),e("p",[t._v("A promise must be in one of three states: pending, fulfilled, or rejected.")]),t._v(" "),t._m(3),t._v(" "),e("p",[t._v("Here, “must not change” means immutable identity (i.e. ===), but does not imply deep immutability.")]),t._v(" "),t._m(4),t._m(5),t._v(" "),e("p",[t._v("A promise must provide a then method to access its current or eventual value or reason.")]),t._v(" "),e("p",[t._v("A promise’s then method accepts two arguments:")]),t._v(" "),e("p",[t._v("promise.then(onFulfilled, onRejected)\nBoth onFulfilled and onRejected are optional arguments:\nIf onFulfilled is not a function, it must be ignored.\nIf onRejected is not a function, it must be ignored.\nIf onFulfilled is a function:\nit must be called after promise is fulfilled, with promise’s value as its first argument.\nit must not be called before promise is fulfilled.\nit must not be called more than once.\nIf onRejected is a function,\nit must be called after promise is rejected, with promise’s reason as its first argument.\nit must not be called before promise is rejected.\nit must not be called more than once.\nonFulfilled or onRejected must not be called until the execution context stack contains only platform code. [3.1].\nonFulfilled and onRejected must be called as functions (i.e. with no this value). [3.2]\nthen may be called multiple times on the same promise.\nIf/when promise is fulfilled, all respective onFulfilled callbacks must execute in the order of their originating calls to then.\nIf/when promise is rejected, all respective onRejected callbacks must execute in the order of their originating calls to then.\nthen must return a promise [3.3].")]),t._v(" "),e("p",[t._v("promise2 = promise1.then(onFulfilled, onRejected);\nIf either onFulfilled or onRejected returns a value x, run the Promise Resolution Procedure [[Resolve]](promise2, x).\nIf either onFulfilled or onRejected throws an exception e, promise2 must be rejected with e as the reason.\nIf onFulfilled is not a function and promise1 is fulfilled, promise2 must be fulfilled with the same value as promise1.\nIf onRejected is not a function and promise1 is rejected, promise2 must be rejected with the same reason as promise1.")])])},[function(){var t=this.$createElement,s=this._self._c||t;return s("h1",{attrs:{id:"promise-实现"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#promise-实现","aria-hidden":"true"}},[this._v("#")]),this._v(" promise 实现")])},function(){var t=this.$createElement,s=this._self._c||t;return s("blockquote",[s("p",[this._v("面试被问到了，说了下思路，回来撸一下完整的")])])},function(){var t=this.$createElement,s=this._self._c||t;return s("h2",{attrs:{id:"_2-1-promise-states"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_2-1-promise-states","aria-hidden":"true"}},[this._v("#")]),this._v(" 2.1 Promise States")])},function(){var t=this,s=t.$createElement,e=t._self._c||s;return e("ul",[e("li",[t._v("2.1.1. When pending, a promise:\n"),e("ul",[e("li",[t._v("2.1.1.1 may transition to either the fulfilled or rejected state.")])])]),t._v(" "),e("li",[t._v("2.1.2. When fulfilled, a promise:\n"),e("ul",[e("li",[t._v("2.1.2.1 must not transition to any other state.")]),t._v(" "),e("li",[t._v("2.1.2.2 must have a value, which must not change.")])])]),t._v(" "),e("li",[t._v("2.1.3. When rejected, a promise:\n"),e("ul",[e("li",[t._v("2.1.3.1 must not transition to any other state.")]),t._v(" "),e("li",[t._v("2.1.3.2 must have a reason, which must not change.")])])])])},function(){var t=this,s=t.$createElement,e=t._self._c||s;return e("div",{staticClass:"language-js extra-class"},[e("pre",{pre:!0,attrs:{class:"language-js"}},[e("code",[e("span",{attrs:{class:"token keyword"}},[t._v("const")]),t._v(" "),e("span",{attrs:{class:"token constant"}},[t._v("PENDING")]),t._v(" "),e("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),e("span",{attrs:{class:"token string"}},[t._v("'pending'")]),t._v("\n"),e("span",{attrs:{class:"token keyword"}},[t._v("const")]),t._v(" "),e("span",{attrs:{class:"token constant"}},[t._v("FULFUILLED")]),t._v(" "),e("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),e("span",{attrs:{class:"token string"}},[t._v("'fulfilled'")]),t._v("\n"),e("span",{attrs:{class:"token keyword"}},[t._v("const")]),t._v(" "),e("span",{attrs:{class:"token constant"}},[t._v("REJECTED")]),t._v(" "),e("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),e("span",{attrs:{class:"token string"}},[t._v("'rejected'")]),t._v("\n\n"),e("span",{attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),e("span",{attrs:{class:"token function"}},[t._v("MyPromise")]),e("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("fn"),e("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),e("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),e("span",{attrs:{class:"token keyword"}},[t._v("this")]),e("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("state "),e("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),e("span",{attrs:{class:"token constant"}},[t._v("PENDING")]),t._v("\n  "),e("span",{attrs:{class:"token keyword"}},[t._v("this")]),e("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("reason\n  "),e("span",{attrs:{class:"token keyword"}},[t._v("this")]),e("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("value\n  "),e("span",{attrs:{class:"token keyword"}},[t._v("let")]),t._v(" self "),e("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),e("span",{attrs:{class:"token keyword"}},[t._v("this")]),t._v("\n\n  "),e("span",{attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),e("span",{attrs:{class:"token function"}},[t._v("resolve")]),e("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("value"),e("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),e("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),e("span",{attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),e("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("self"),e("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("state "),e("span",{attrs:{class:"token operator"}},[t._v("===")]),t._v(" "),e("span",{attrs:{class:"token constant"}},[t._v("PENDING")]),e("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),e("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n      self"),e("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("state "),e("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),e("span",{attrs:{class:"token constant"}},[t._v("FULFUILLED")]),t._v("\n      self"),e("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("value "),e("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" value\n    "),e("span",{attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n  "),e("span",{attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n  "),e("span",{attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),e("span",{attrs:{class:"token function"}},[t._v("reject")]),e("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("reason"),e("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),e("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),e("span",{attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),e("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("self"),e("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("state "),e("span",{attrs:{class:"token operator"}},[t._v("===")]),t._v(" "),e("span",{attrs:{class:"token constant"}},[t._v("PENDING")]),e("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),e("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n      self"),e("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("state "),e("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),e("span",{attrs:{class:"token constant"}},[t._v("REJECTED")]),t._v("\n      self"),e("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("reason "),e("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" reason\n    "),e("span",{attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n  "),e("span",{attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n  "),e("span",{attrs:{class:"token function"}},[t._v("fn")]),e("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("resolve"),e("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" reject"),e("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),e("span",{attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])])},function(){var t=this.$createElement,s=this._self._c||t;return s("h2",{attrs:{id:"_2-2-the-then-method"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_2-2-the-then-method","aria-hidden":"true"}},[this._v("#")]),this._v(" 2.2 The then Method")])}],!1,null,null,null);a.options.__file="promise.md";s.default=a.exports}}]);