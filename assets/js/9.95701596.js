(window.webpackJsonp=window.webpackJsonp||[]).push([[9],{197:function(t,s,n){"use strict";n.r(s);var a=n(0),e=Object(a.a)({},function(){var t=this,s=t.$createElement,n=t._self._c||s;return n("div",{staticClass:"content"},[t._m(0),t._v(" "),t._m(1),t._v(" "),n("p",[t._v("event 上有一个属性 isTrusted，true 表示由用户行为触发；false 表示由程序生成。")]),t._v(" "),t._m(2),t._v(" "),t._m(3),t._v(" "),t._m(4),n("ul",[n("li",[n("p",[t._v("type 是 "),n("a",{attrs:{href:"https://developer.mozilla.org/zh-CN/docs/Web/API/DOMString",target:"_blank",rel:"noopener noreferrer"}},[t._v("DOMString"),n("OutboundLink")],1),t._v(" 类型，表示事件名称；")])]),t._v(" "),n("li",[n("p",[t._v("new Event 的第二个参数是 "),n("a",{attrs:{href:"https://dom.spec.whatwg.org/#dictdef-eventinit",target:"_blank",rel:"noopener noreferrer"}},[t._v("EventInit"),n("OutboundLink")],1),t._v(" 类型，接受 bubbles、cancelabel、composed 三个字段，均为 boolean 类型，默认 false。")])]),t._v(" "),n("li",[n("p",[t._v("new CustomEvent 的第二个参数是 "),n("a",{attrs:{href:"https://dom.spec.whatwg.org/#dictdef-customeventinit",target:"_blank",rel:"noopener noreferrer"}},[t._v("CustomEventInit"),n("OutboundLink")],1),t._v(" 类型，可以使用 detail 字段来传递自定义数据。")])]),t._v(" "),n("li",[n("p",[t._v("document.createEvent 是在 Event 接口标准化之前广泛使用的事件创建方式，不建议再使用。interface 接受一个参数列表 "),n("a",{attrs:{href:"https://dom.spec.whatwg.org/#dom-document-createevent",target:"_blank",rel:"noopener noreferrer"}},[t._v("createevent"),n("OutboundLink")],1),t._v("，例如 Event、TextEvent、KeyboardEvent 等。\n使用 createEvent 创建的事件必须被初始化后才能使用。")])])]),t._v(" "),n("p",[n("a",{attrs:{href:"https://dom.spec.whatwg.org/#interface-event",target:"_blank",rel:"noopener noreferrer"}},[t._v("interface-event"),n("OutboundLink")],1)]),t._v(" "),t._m(5),t._v(" "),t._m(6),n("p",[t._v("mouseEventInit 参数包括了继承自 Event 和 UIEvent 的字段，同时还拥有自身相关的 screenX、screenY、pageX、pageY、clientX、clientY、x、y、offsetX、offsetY 等字段。")]),t._v(" "),t._m(7),t._v(" "),t._m(8),t._v(" "),t._m(9),t._v(" "),n("p",[t._v("如果是一个 click 事件，是不是就真的这么简单呢？")]),t._v(" "),t._m(10),n("p",[t._v("上文的五种事件定义方式在 dispatchEvent 时都会触发 click 事件，但是只有 ev4、ev5、HTMLElement.click() 能够修改 chechbox.checked 值。")]),t._v(" "),n("p",[t._v("我是这样理解的，勾选一个 checkbox input 的动作是用户动作产生的，浏览器通过监听这个动作产生的事件来完成默认行为。而在处理 click 事件时做了除 event.type 以外的判断，因此仅仅使用自定义事件并不能完全模拟浏览器的默认行为。")]),t._v(" "),n("p",[t._v("不仅仅是 input 元素，还有 a、button、设置了 controls 属性的 video 和 audio 等元素都属于 "),n("a",{attrs:{href:"https://www.w3.org/TR/html50/dom.html#interactive-content-0",target:"_blank",rel:"noopener noreferrer"}},[t._v("interactive-content"),n("OutboundLink")],1),t._v("。这些可交互元素都有自身预设的激活行为，比如 a 会跳转到指定的链接、checkbox input 会改变 checked 值等。")]),t._v(" "),t._m(11),t._v(" "),t._m(12),t._v(" "),t._m(13),t._v(" "),t._m(14),t._v(" "),n("p",[t._v("阻止默认行为，例如阻止跳转到 a.href 地址。")]),t._v(" "),t._m(15),n("p",[t._v("阻止事件默认行为原本没什么好说的，但是遇到了一个困惑的地方。")]),t._v(" "),n("p",[t._v("使用了 preventDefault 后，用户行为和 ele.click 引起的默认行为确实被阻止了。click 方法在执行 synthetic click activation 的 dispatch 步骤时由于事件被取消，因此不再继续 post-click activation steps。")]),t._v(" "),n("p",[t._v("但是 dispatchEvent(new MouseEvent('click')) 无视了这一条，还是该怎么样就怎么样？百思不得其解...")]),t._v(" "),n("p",[n("a",{attrs:{href:"https://codepen.io/dashdotdawn/pen/gdoxBp",target:"_blank",rel:"noopener noreferrer"}},[t._v("DEMO"),n("OutboundLink")],1)]),t._v(" "),t._m(16),t._v(" "),n("p",[t._v("composed 不太理解")])])},[function(){var t=this.$createElement,s=this._self._c||t;return s("h1",{attrs:{id:"事件创建与分发"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#事件创建与分发","aria-hidden":"true"}},[this._v("#")]),this._v(" 事件创建与分发")])},function(){var t=this.$createElement,s=this._self._c||t;return s("p",[this._v("通过程序进行创建与分发的事件称作合成事件 "),s("code",[this._v("synthetic events")]),this._v("，区别于浏览器自身触发的事件。")])},function(){var t=this.$createElement,s=this._self._c||t;return s("h2",{attrs:{id:"事件创建"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#事件创建","aria-hidden":"true"}},[this._v("#")]),this._v(" 事件创建")])},function(){var t=this.$createElement,s=this._self._c||t;return s("ol",[s("li",[this._v("自定义事件")])])},function(){var t=this,s=t.$createElement,n=t._self._c||s;return n("div",{staticClass:"language-js extra-class"},[n("pre",{pre:!0,attrs:{class:"language-js"}},[n("code",[n("span",{attrs:{class:"token keyword"}},[t._v("var")]),t._v(" ev1 "),n("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),n("span",{attrs:{class:"token class-name"}},[t._v("Event")]),n("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("type"),n("span",{attrs:{class:"token punctuation"}},[t._v("[")]),n("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" eventInitDict"),n("span",{attrs:{class:"token punctuation"}},[t._v("]")]),n("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{attrs:{class:"token comment"}},[t._v("// 自定义事件")]),t._v("\n\n"),n("span",{attrs:{class:"token keyword"}},[t._v("var")]),t._v(" ev2 "),n("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),n("span",{attrs:{class:"token class-name"}},[t._v("CustomEvent")]),n("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("type"),n("span",{attrs:{class:"token punctuation"}},[t._v("[")]),n("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" eventInitDict"),n("span",{attrs:{class:"token punctuation"}},[t._v("]")]),n("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{attrs:{class:"token comment"}},[t._v("// 自定义事件传入自定义数据")]),t._v("\n\n"),n("span",{attrs:{class:"token keyword"}},[t._v("var")]),t._v(" ev3 "),n("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" document"),n("span",{attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{attrs:{class:"token function"}},[t._v("createEvent")]),n("span",{attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{attrs:{class:"token keyword"}},[t._v("interface")]),n("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{attrs:{class:"token comment"}},[t._v("// 曾经的做法")]),t._v("\nev3"),n("span",{attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{attrs:{class:"token function"}},[t._v("initEvent")]),n("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("type"),n("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" bubbles"),n("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" cancelable"),n("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])])},function(){var t=this.$createElement,s=this._self._c||t;return s("ol",{attrs:{start:"2"}},[s("li",[this._v("内置事件")])])},function(){var t=this,s=t.$createElement,n=t._self._c||s;return n("div",{staticClass:"language-js extra-class"},[n("pre",{pre:!0,attrs:{class:"language-js"}},[n("code",[n("span",{attrs:{class:"token keyword"}},[t._v("var")]),t._v(" ev4 "),n("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),n("span",{attrs:{class:"token class-name"}},[t._v("MouseEvent")]),n("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("type"),n("span",{attrs:{class:"token punctuation"}},[t._v("[")]),n("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" mouseEventInit"),n("span",{attrs:{class:"token punctuation"}},[t._v("]")]),n("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])])},function(){var t=this.$createElement,s=this._self._c||t;return s("h2",{attrs:{id:"事件分发"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#事件分发","aria-hidden":"true"}},[this._v("#")]),this._v(" 事件分发")])},function(){var t=this.$createElement,s=this._self._c||t;return s("p",[s("code",[this._v("elem.dispatchEvent(event)")]),this._v(" 可以用来触发事件。")])},function(){var t=this.$createElement,s=this._self._c||t;return s("h3",{attrs:{id:"模拟-click-事件"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#模拟-click-事件","aria-hidden":"true"}},[this._v("#")]),this._v(" 模拟 click 事件")])},function(){var t=this,s=t.$createElement,n=t._self._c||s;return n("div",{staticClass:"language-html extra-class"},[n("pre",{pre:!0,attrs:{class:"language-html"}},[n("code",[n("span",{attrs:{class:"token tag"}},[n("span",{attrs:{class:"token tag"}},[n("span",{attrs:{class:"token punctuation"}},[t._v("<")]),t._v("input")]),t._v(" "),n("span",{attrs:{class:"token attr-name"}},[t._v("type")]),n("span",{attrs:{class:"token attr-value"}},[n("span",{attrs:{class:"token punctuation"}},[t._v("=")]),n("span",{attrs:{class:"token punctuation"}},[t._v('"')]),t._v("checkbox"),n("span",{attrs:{class:"token punctuation"}},[t._v('"')])]),t._v(" "),n("span",{attrs:{class:"token attr-name"}},[t._v("id")]),n("span",{attrs:{class:"token attr-value"}},[n("span",{attrs:{class:"token punctuation"}},[t._v("=")]),n("span",{attrs:{class:"token punctuation"}},[t._v('"')]),t._v("check"),n("span",{attrs:{class:"token punctuation"}},[t._v('"')])]),n("span",{attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n"),n("span",{attrs:{class:"token tag"}},[n("span",{attrs:{class:"token tag"}},[n("span",{attrs:{class:"token punctuation"}},[t._v("<")]),t._v("script")]),n("span",{attrs:{class:"token punctuation"}},[t._v(">")])]),n("span",{attrs:{class:"token script language-javascript"}},[t._v("\n  "),n("span",{attrs:{class:"token keyword"}},[t._v("const")]),t._v(" ev1 "),n("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),n("span",{attrs:{class:"token class-name"}},[t._v("Event")]),n("span",{attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{attrs:{class:"token string"}},[t._v("'click'")]),n("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{attrs:{class:"token comment"}},[t._v("// 自定义事件")]),t._v("\n\n  "),n("span",{attrs:{class:"token keyword"}},[t._v("const")]),t._v(" ev2 "),n("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),n("span",{attrs:{class:"token class-name"}},[t._v("CustomEvent")]),n("span",{attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{attrs:{class:"token string"}},[t._v("'click'")]),n("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{attrs:{class:"token comment"}},[t._v("// 自定义事件传入自定义数据")]),t._v("\n\n  "),n("span",{attrs:{class:"token keyword"}},[t._v("const")]),t._v(" ev3 "),n("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" document"),n("span",{attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{attrs:{class:"token function"}},[t._v("createEvent")]),n("span",{attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{attrs:{class:"token string"}},[t._v("'Event'")]),n("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{attrs:{class:"token comment"}},[t._v("// 曾经的做法")]),t._v("\n  ev3"),n("span",{attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{attrs:{class:"token function"}},[t._v("initEvent")]),n("span",{attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{attrs:{class:"token string"}},[t._v("'click'")]),n("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n  "),n("span",{attrs:{class:"token keyword"}},[t._v("const")]),t._v(" ev4 "),n("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),n("span",{attrs:{class:"token class-name"}},[t._v("MouseEvent")]),n("span",{attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{attrs:{class:"token string"}},[t._v("'click'")]),n("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{attrs:{class:"token comment"}},[t._v("// 内置事件")]),t._v("\n\n  "),n("span",{attrs:{class:"token keyword"}},[t._v("const")]),t._v(" ev5 "),n("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" document"),n("span",{attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{attrs:{class:"token function"}},[t._v("createEvent")]),n("span",{attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{attrs:{class:"token string"}},[t._v("'MouseEvent'")]),n("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n  ev5"),n("span",{attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{attrs:{class:"token function"}},[t._v("initEvent")]),n("span",{attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{attrs:{class:"token string"}},[t._v("'click'")]),n("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n  document"),n("span",{attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{attrs:{class:"token function"}},[t._v("getElementById")]),n("span",{attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{attrs:{class:"token string"}},[t._v("'check'")]),n("span",{attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{attrs:{class:"token function"}},[t._v("addEventListener")]),n("span",{attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{attrs:{class:"token string"}},[t._v("'click'")]),n("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("e"),n("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),n("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    console"),n("span",{attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{attrs:{class:"token function"}},[t._v("log")]),n("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("e"),n("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n  "),n("span",{attrs:{class:"token punctuation"}},[t._v("}")]),n("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n  "),n("span",{attrs:{class:"token comment"}},[t._v("// document.getElementById('check').dispatchEvent(ev1)")]),t._v("\n  "),n("span",{attrs:{class:"token comment"}},[t._v("// document.getElementById('check').click()")]),t._v("\n")]),n("span",{attrs:{class:"token tag"}},[n("span",{attrs:{class:"token tag"}},[n("span",{attrs:{class:"token punctuation"}},[t._v("</")]),t._v("script")]),n("span",{attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n")])])])},function(){var t=this.$createElement,s=this._self._c||t;return s("p",[this._v("用户对元素的激活可能触发一系列事件，通常最后会是 click 事件，如果用户使用了 click 以外的方式触发了元素的激活行为，那么该交互事件应当在元素上 "),s("code",[this._v("run synthetic click activation steps")]),this._v("，也就是执行合成的点击激活步骤。在这个模拟过程中，如果 click event 在 dispatch 后没有被取消，那么接着就会 "),s("code",[this._v("run post-click activation steps")]),this._v("，此时才完成交互元素的默认激活行为。")])},function(){var t=this.$createElement,s=this._self._c||t;return s("p",[this._v("HTMLElement.click 是一个通过程序调用完成 "),s("code",[this._v("run synthetic click activation steps")]),this._v(" 的方法，因此可以用来模拟点击行为。")])},function(){var t=this.$createElement,s=this._self._c||t;return s("blockquote",[s("p",[this._v("综上")]),this._v(" "),s("p",[this._v("问：用程序模拟点击一个链接作跳转")]),this._v(" "),s("p",[this._v("答：a.click 或 a.dispatchEvent(new MouseEvent('click')) 实现")])])},function(){var t=this.$createElement,s=this._self._c||t;return s("h2",{attrs:{id:"阻止默认行为"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#阻止默认行为","aria-hidden":"true"}},[this._v("#")]),this._v(" 阻止默认行为")])},function(){var t=this,s=t.$createElement,n=t._self._c||s;return n("div",{staticClass:"language-js extra-class"},[n("pre",{pre:!0,attrs:{class:"language-js"}},[n("code",[t._v("ele"),n("span",{attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{attrs:{class:"token function-variable function"}},[t._v("onclick")]),t._v(" "),n("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),n("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("e"),n("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),n("span",{attrs:{class:"token keyword"}},[t._v("return")]),t._v(" "),n("span",{attrs:{class:"token boolean"}},[t._v("false")]),t._v("\n"),n("span",{attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\nele"),n("span",{attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{attrs:{class:"token function"}},[t._v("addEventListener")]),n("span",{attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{attrs:{class:"token string"}},[t._v("'click'")]),n("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),n("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("e"),n("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  e"),n("span",{attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{attrs:{class:"token function"}},[t._v("preventDefault")]),n("span",{attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),n("span",{attrs:{class:"token punctuation"}},[t._v("}")]),n("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])])},function(){var t=this.$createElement,s=this._self._c||t;return s("h2",{attrs:{id:"todo"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#todo","aria-hidden":"true"}},[this._v("#")]),this._v(" TODO")])}],!1,null,null,null);e.options.__file="create_event.md";s.default=e.exports}}]);