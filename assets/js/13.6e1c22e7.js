(window.webpackJsonp=window.webpackJsonp||[]).push([[13],{165:function(e,s,t){e.exports=t.p+"assets/img/ssl_upyun.f8567ebe.jpg"},201:function(e,s,t){"use strict";t.r(s);var v=[function(){var e=this,s=e.$createElement,v=e._self._c||s;return v("div",{staticClass:"content"},[v("h1",{attrs:{id:"https"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#https","aria-hidden":"true"}},[e._v("#")]),e._v(" https")]),e._v(" "),v("p",[e._v("HTTPS = HTTP + SSL/TLS，默认端口 443，TCP 三次握手 + SSL 四次握手")]),e._v(" "),v("h2",{attrs:{id:"ssl-过程"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#ssl-过程","aria-hidden":"true"}},[e._v("#")]),e._v(" ssl 过程")]),e._v(" "),v("p",[e._v("SSL(Secure Socket Layer) 是 TLS(Transport Layer Security) 的前身，SSL 从 3.1 开始被标准化并改名为 TLS")]),e._v(" "),v("p",[e._v("ssl / tls 握手的过程就是为了协商出一个安全的对称密钥，基本步骤如下")]),e._v(" "),v("ul",[v("li",[e._v("client: hello")]),e._v(" "),v("li",[e._v("server: hello 给你一个证书")]),e._v(" "),v("li",[e._v("client: 查过了 ssl 是真的, 得到 pub_key")]),e._v(" "),v("li",[e._v("client: pub_key 加密(对称加密算法 + 对称密钥)")]),e._v(" "),v("li",[e._v("server: private_key 解密，得到(对称加密算法 + 对称密钥)，后续采用对称密钥加密通话")])]),e._v(" "),v("p",[e._v("具体的实现涉及 tls 不同版本稍有出入，通过 "),v("code",[e._v("wireshark")]),e._v(" 查看了访问 upyun 的过程\n"),v("img",{attrs:{src:t(165),alt:""}})]),e._v(" "),v("ol",[v("li",[e._v("client: Client Hello(随机数 + 客户端支持的加密算法 + session ID)")]),e._v(" "),v("li",[e._v("server: Server Hello(随机数 + 确定使用的加密算法)")]),e._v(" "),v("li",[e._v("server: Certificate 证书")]),e._v(" "),v("li",[e._v("server: Server Key Exchange(EC Diffie-Hellman Server Params 中有 curve、pubkey 和 signature) + Server Hello Done")]),e._v(" "),v("li",[e._v("client: Client Key Exchange(根据给定的 DH 算法得出的 pubkey) + Change Cipher Spec(接下来只发加密消息) + Encrypted Handshake Message(发个加密消息你看能解吗)")]),e._v(" "),v("li",[e._v("server: New Session Ticket(给你一个 session ticket 来维持我们的友谊) + Change Cipher Spec(同上) + Encrypted Handshake Message(同上)")]),e._v(" "),v("li",[e._v("之后都是加密后的 Application Data 通信")])]),e._v(" "),v("p",[e._v("其中第一步的 session id 可以在中断后快速恢复连接，不需要再次握手进行密钥协商")]),e._v(" "),v("h2",{attrs:{id:"ssl-证书验证"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#ssl-证书验证","aria-hidden":"true"}},[e._v("#")]),e._v(" SSL 证书验证")]),e._v(" "),v("p",[e._v("证书内容")]),e._v(" "),v("ul",[v("li",[e._v("CA")]),e._v(" "),v("li",[e._v("有效期")]),e._v(" "),v("li",[e._v("公钥")]),e._v(" "),v("li",[e._v("所有者")]),e._v(" "),v("li",[e._v("签名")])]),e._v(" "),v("p",[e._v("浏览器验证证书首先会：判断有效期；比对内置的受信 CA；"),v("code",[e._v("[incomplete]")])]),e._v(" "),v("p",[e._v("浏览器验证证书链的方式")]),e._v(" "),v("ul",[v("li",[e._v("CRL 维护并定时更新证书撤销名单")]),e._v(" "),v("li",[e._v("OCSP 实时在线证书验证协议")]),e._v(" "),v("li",[e._v("OCSP stapling 服务器模拟客户端验证，将 OCSP 响应和证书链一起下发给客户端，因此浏览器不需要再想 CA 站点查询证书状态")])])])}],_=t(0),i=Object(_.a)({},function(){this.$createElement;this._self._c;return this._m(0)},v,!1,null,null,null);i.options.__file="https.md";s.default=i.exports}}]);